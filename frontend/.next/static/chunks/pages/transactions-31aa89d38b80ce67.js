(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[673],{4314:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1373);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]])},2112:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1373);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]])},3766:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1373);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},1012:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1373);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7705:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1373);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},3718:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(1373);/**
 * @license lucide-react v0.441.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,s.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},28:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/transactions",function(){return a(7824)}])},7824:function(e,t,a){"use strict";a.r(t);var s=a(5893),n=a(7294),r=a(1144),i=a(5843),l=a(2785),c=a(2112),o=a(4314),d=a(8142),u=a(1012),x=a(3766),m=a(7705),h=a(3718),p=a(1352);t.default=()=>{let{user:e}=(0,r.aC)(),[t,a]=(0,n.useState)([]),[f,b]=(0,n.useState)([]),[y,g]=(0,n.useState)(!1),[v,j]=(0,n.useState)(!1),[N,w]=(0,n.useState)(0),[_,k]=(0,n.useState)(!1),[C,T]=(0,n.useState)(null),[Z,S]=(0,n.useState)(null),[E,M]=(0,n.useState)(!1),[D,A]=(0,n.useState)(null),[P,I]=(0,n.useState)({chart_account_id:"",transaction_date:"",amount:"",description:"",transaction_type:"receita",notes:""});(0,n.useEffect)(()=>{(null==e?void 0:e.business_unit_id)&&(loadTransactions(e.business_unit_id),loadChartAccounts(e.business_unit_id))},[e]);let loadTransactions=async e=>{g(!0);try{let t=await i.ZP.get("/api/v1/financial/transactions?business_unit_id=".concat(e));a(t.data)}catch(e){console.error("Erro ao carregar transa\xe7\xf5es:",e)}finally{g(!1)}},loadChartAccounts=async e=>{try{let t=await i.ZP.get("/api/v1/chart-accounts/hierarchy?business_unit_id=".concat(e)),a=t.data.accounts||[];b(a)}catch(e){console.error("Erro ao carregar contas:",e)}},handleUpload=async()=>{if(!C||!(null==e?void 0:e.business_unit_id))return;j(!0),w(0);let t=setInterval(()=>{w(e=>e>=90?(clearInterval(t),90):e+10)},100),a=new FormData;a.append("file",C),a.append("business_unit_id",e.business_unit_id);try{let t=await i.ZP.post("/api/v1/financial/transactions/import-csv",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:e=>{if(e.total){let t=Math.round(100*e.loaded/e.total);w(t)}}});w(100),S(t.data),t.data.summary.processed>0&&loadTransactions(e.business_unit_id)}catch(e){var s,n;alert((null===(n=e.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.detail)||"Erro ao importar arquivo")}finally{j(!1),w(0),setTimeout(()=>{k(!1),T(null),S(null)},2e3)}},handleCreateTransaction=async()=>{if(!(null==e?void 0:e.business_unit_id)||!P.chart_account_id||!P.transaction_date||!P.amount){alert("Por favor, preencha todos os campos obrigat\xf3rios.");return}try{await i.ZP.post("/api/v1/financial/transactions",{...P,business_unit_id:e.business_unit_id,amount:parseFloat(P.amount)}),M(!1),I({chart_account_id:"",transaction_date:"",amount:"",description:"",transaction_type:"receita",notes:""}),loadTransactions(e.business_unit_id)}catch(e){var t,a;alert((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.detail)||"Erro ao criar transa\xe7\xe3o")}},handleUpdateTransaction=async()=>{if(D&&P.chart_account_id&&P.transaction_date&&P.amount)try{await i.ZP.post("/api/v1/financial/transactions/".concat(D.id),{...P,amount:parseFloat(P.amount)}),M(!1),A(null),I({chart_account_id:"",transaction_date:"",amount:"",description:"",transaction_type:"receita",notes:""}),loadTransactions(e.business_unit_id)}catch(e){var t,a;alert((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.detail)||"Erro ao atualizar transa\xe7\xe3o")}},handleDeleteTransaction=async t=>{if(confirm("Tem certeza que deseja excluir esta transa\xe7\xe3o?"))try{await i.ZP.delete("/api/v1/financial/transactions/".concat(t)),loadTransactions(e.business_unit_id)}catch(e){var a,s;alert((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.detail)||"Erro ao excluir transa\xe7\xe3o")}},handleEditTransaction=e=>{A(e),I({chart_account_id:e.chart_account_id,transaction_date:e.transaction_date.split(" ")[0],amount:e.amount.toString(),description:e.description,transaction_type:e.transaction_type,notes:e.notes||""}),M(!0)},formatDate=e=>new Date(e).toLocaleDateString("pt-BR"),formatCurrency=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),getTransactionTypeIcon=e=>"receita"===e?(0,s.jsx)(c.Z,{className:"w-4 h-4 text-green-600"}):(0,s.jsx)(o.Z,{className:"w-4 h-4 text-red-600"}),getTransactionTypeColor=e=>"receita"===e?"text-green-600":"text-red-600",getStatusColor=e=>{switch(e){case"aprovada":return"text-green-600";case"pendente":return"text-yellow-600";case"rejeitada":return"text-red-600";default:return"text-gray-600"}};return(0,s.jsx)(l.Z,{children:(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Transa\xe7\xf5es Financeiras"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Gerencie as transa\xe7\xf5es financeiras da sua unidade de neg\xf3cio"})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Importar CSV"]}),(0,s.jsxs)("button",{onClick:()=>M(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Nova Transa\xe7\xe3o"]})]})]})}),(null==e?void 0:e.business_unit_id)&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Transa\xe7\xf5es (",t.length,")"]})}),y?(0,s.jsxs)("div",{className:"p-6 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"Carregando transa\xe7\xf5es..."})]}):0===t.length?(0,s.jsxs)("div",{className:"p-6 text-center",children:[(0,s.jsx)(x.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Nenhuma transa\xe7\xe3o encontrada"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"Comece criando uma nova transa\xe7\xe3o ou importando um arquivo CSV"})]}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Refer\xeancia"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conta"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descri\xe7\xe3o"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.reference||"N/A"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.chart_account_name||"N/A"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.chart_account_code||"N/A"})]})}),(0,s.jsx)("td",{className:"px-6 py-4",children:(0,s.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:e.description||"N/A"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:formatDate(e.transaction_date)}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("div",{className:"text-sm font-medium ".concat(getTransactionTypeColor(e.transaction_type)),children:formatCurrency(e.amount)})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[getTransactionTypeIcon(e.transaction_type),(0,s.jsx)("span",{className:"ml-1 text-sm font-medium ".concat(getTransactionTypeColor(e.transaction_type)),children:"receita"===e.transaction_type?"Receita":"Despesa"})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(getStatusColor(e.status)),children:e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"N/A"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>handleEditTransaction(e),className:"text-blue-600 hover:text-blue-900",children:(0,s.jsx)(m.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>handleDeleteTransaction(e.id),className:"text-red-600 hover:text-red-900",children:(0,s.jsx)(h.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})]}),_&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,s.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Importar Transa\xe7\xf5es CSV"}),(0,s.jsx)("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(p.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecionar Arquivo CSV"}),(0,s.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&"text/csv"===a.type?T(a):alert("Por favor, selecione um arquivo CSV v\xe1lido.")},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),C&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-blue-50 rounded-md",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800",children:["Arquivo selecionado: ",C.name]})}),v&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(N,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Importando... ",N,"%"]})]}),Z&&(0,s.jsxs)("div",{className:"mb-4 p-3 bg-green-50 rounded-md",children:[(0,s.jsx)("div",{className:"text-sm text-green-800",children:Z.message}),(0,s.jsxs)("div",{className:"text-sm text-green-700 mt-1",children:["Processadas: ",Z.summary.processed," | Erros: ",Z.summary.errors]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancelar"}),(0,s.jsx)("button",{onClick:handleUpload,disabled:!C||v,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 rounded-md",children:v?"Importando...":"Importar"})]})]})})}),E&&(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,s.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:D?"Editar Transa\xe7\xe3o":"Nova Transa\xe7\xe3o"}),(0,s.jsx)("button",{onClick:()=>{M(!1),A(null),I({chart_account_id:"",transaction_date:"",amount:"",description:"",transaction_type:"receita",notes:""})},className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(p.Z,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Conta Cont\xe1bil *"}),(0,s.jsxs)("select",{value:P.chart_account_id,onChange:e=>I({...P,chart_account_id:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"",children:"Selecione uma conta"}),f.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.code," - ",e.name]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data *"}),(0,s.jsx)("input",{type:"date",value:P.transaction_date,onChange:e=>I({...P,transaction_date:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor *"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:P.amount,onChange:e=>I({...P,amount:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descri\xe7\xe3o *"}),(0,s.jsx)("textarea",{value:P.description,onChange:e=>I({...P,description:e.target.value}),rows:3,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Descri\xe7\xe3o da transa\xe7\xe3o..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),(0,s.jsxs)("select",{value:P.transaction_type,onChange:e=>I({...P,transaction_type:e.target.value}),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,s.jsx)("option",{value:"receita",children:"Receita"}),(0,s.jsx)("option",{value:"despesa",children:"Despesa"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa\xe7\xf5es"}),(0,s.jsx)("textarea",{value:P.notes,onChange:e=>I({...P,notes:e.target.value}),rows:2,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Observa\xe7\xf5es adicionais..."})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,s.jsx)("button",{onClick:()=>{M(!1),A(null),I({chart_account_id:"",transaction_date:"",amount:"",description:"",transaction_type:"receita",notes:""})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Cancelar"}),(0,s.jsx)("button",{onClick:D?handleUpdateTransaction:handleCreateTransaction,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:D?"Atualizar":"Criar"})]})]})})})]})})})}}},function(e){e.O(0,[607,899,785,774,888,179],function(){return e(e.s=28)}),_N_E=e.O()}]);