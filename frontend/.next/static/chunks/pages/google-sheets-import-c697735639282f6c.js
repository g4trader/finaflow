(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{32:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/google-sheets-import",function(){return a(3759)}])},3157:function(e,s,a){"use strict";var t=a(5893);a(7294);var r=a(607);let Card=e=>{let{children:s,className:a="",hover:l=!1,padding:n="md"}=e,d=["card",{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[n],l?"hover:shadow-medium transition-shadow duration-200":"",a].filter(Boolean).join(" ");return(0,t.jsx)(r.E.div,{className:d,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},whileHover:l?{y:-2}:{},children:s})};Card.Header=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"card-header ".concat(a),children:s})},Card.Body=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"card-body ".concat(a),children:s})},Card.Footer=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"card-footer ".concat(a),children:s})},s.Z=Card},8024:function(e,s,a){"use strict";var t=a(5893),r=a(7294);let l=(0,r.forwardRef)((e,s)=>{let{label:a,error:r,helperText:l,icon:n,iconPosition:d="left",fullWidth:c=!1,className:i="",...o}=e,x=["input",r?"input-error":"",n?"left"===d?"pl-10":"pr-10":"",c?"w-full":"",i].filter(Boolean).join(" ");return(0,t.jsxs)("div",{className:c?"w-full":"",children:[a&&(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a}),(0,t.jsxs)("div",{className:"relative",children:[n&&(0,t.jsx)("div",{className:"absolute inset-y-0 ".concat("left"===d?"left-0 pl-3":"right-0 pr-3"," flex items-center pointer-events-none"),children:(0,t.jsx)("span",{className:"text-gray-400 ".concat(r?"text-red-400":""),children:n})}),(0,t.jsx)("input",{ref:s,className:x,...o})]}),r&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r}),l&&!r&&(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l})]})});l.displayName="Input",s.Z=l},7571:function(e,s,a){"use strict";var t=a(5893),r=a(7294),l=a(1352),n=a(4530);s.Z=e=>{let{isOpen:s,onClose:a,title:d,children:c,size:i="md",showCloseButton:o=!0}=e;return((0,r.useEffect)(()=>{let handleEscape=e=>{"Escape"===e.key&&a()};return s&&(document.addEventListener("keydown",handleEscape),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",handleEscape),document.body.style.overflow="unset"}},[s,a]),s)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:a}),(0,t.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"relative w-full ".concat({sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[i]," bg-white rounded-xl shadow-xl"),onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:d}),o&&(0,t.jsx)(n.Z,{variant:"ghost",size:"sm",onClick:a,icon:(0,t.jsx)(l.Z,{className:"w-4 h-4"})})]}),(0,t.jsx)("div",{className:"p-6",children:c})]})})]}):null}},3759:function(e,s,a){"use strict";a.r(s);var t=a(5893),r=a(7294),l=a(1163),n=a(2785),d=a(4530),c=a(8024),i=a(3157),o=a(7571),x=a(5843);s.default=()=>{(0,l.useRouter)();let[e,s]=(0,r.useState)(""),[a,m]=(0,r.useState)(null),[h,u]=(0,r.useState)(null),[p,j]=(0,r.useState)(null),[g,N]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),[w,_]=(0,r.useState)("all");(0,r.useEffect)(()=>{loadSampleInfo()},[]);let loadSampleInfo=async()=>{try{let e=await (0,x.ax)();m(e),s(e.spreadsheet_id)}catch(e){console.error("Erro ao carregar informa\xe7\xf5es da planilha de exemplo:",e)}},handleValidate=async()=>{if(!e.trim()){alert("Por favor, insira o ID da planilha");return}N(!0);try{let s=await (0,x.jc)(e);u(s),b(!0)}catch(e){console.error("Erro na valida\xe7\xe3o:",e),alert("Erro na valida\xe7\xe3o: "+(e.message||"Erro desconhecido"))}finally{N(!1)}},handleImport=async function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e.trim()){alert("Por favor, insira o ID da planilha");return}N(!0);try{let a=await (0,x.A5)({spreadsheet_id:e,import_type:w,validate_only:s});j(a),y(!0)}catch(e){console.error("Erro na importa\xe7\xe3o:",e),alert("Erro na importa\xe7\xe3o: "+(e.message||"Erro desconhecido"))}finally{N(!1)}},copySpreadsheetId=e=>{navigator.clipboard.writeText(e),alert("ID copiado para a \xe1rea de transfer\xeancia!")};return(0,t.jsxs)(n.Z,{children:[(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83D\uDCCA Importa\xe7\xe3o Google Sheets"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Importe dados da metodologia Ana Paula diretamente do Google Sheets"})]}),a&&(0,t.jsxs)(i.Z,{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCCB Planilha de Exemplo"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID da Planilha:"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(c.Z,{value:a.spreadsheet_id,readOnly:!0,className:"flex-1"}),(0,t.jsx)(d.Z,{onClick:()=>copySpreadsheetId(a.spreadsheet_id),variant:"secondary",size:"sm",children:"Copiar"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,t.jsx)("strong",{children:"Descri\xe7\xe3o:"})," ",a.description]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,t.jsx)("strong",{children:"Total de abas:"})," ",a.sheets.length]}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Abas dispon\xedveis:"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.sheets.slice(0,8).map((e,s)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:e},s)),a.sheets.length>8&&(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",a.sheets.length-8," mais"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Instru\xe7\xf5es:"}),(0,t.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:a.instructions.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start",children:[(0,t.jsx)("span",{className:"mr-2",children:"•"}),(0,t.jsx)("span",{children:e})]},s))})]})]})]})]}),(0,t.jsxs)(i.Z,{className:"mb-8",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDE80 Importar Dados"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID da Planilha Google Sheets:"}),(0,t.jsx)(c.Z,{value:e,onChange:e=>s(e.target.value),placeholder:"Cole aqui o ID da planilha (ex: 1yyHuP6qjnK2Rd26yPPzaOqi_OJVeRjAJnewRIOJvFVY)",className:"w-full"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"O ID pode ser encontrado na URL da planilha: docs.google.com/spreadsheets/d/[ID]/edit"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Importa\xe7\xe3o:"}),(0,t.jsxs)("select",{value:w,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"all",children:"Todos os dados"}),(0,t.jsx)("option",{value:"accounts",children:"Apenas estrutura de contas"}),(0,t.jsx)("option",{value:"transactions",children:"Apenas transa\xe7\xf5es"}),(0,t.jsx)("option",{value:"reports",children:"Apenas relat\xf3rios"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsx)(d.Z,{onClick:handleValidate,loading:g,variant:"secondary",className:"flex-1",children:"\uD83D\uDD0D Validar Planilha"}),(0,t.jsx)(d.Z,{onClick:()=>handleImport(!0),loading:g,variant:"secondary",className:"flex-1",children:"✅ Validar Importa\xe7\xe3o"}),(0,t.jsx)(d.Z,{onClick:()=>handleImport(!1),loading:g,className:"flex-1",children:"\uD83D\uDCE5 Importar Dados"})]})]})]}),(h||p)&&(0,t.jsxs)(i.Z,{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\uD83D\uDCCA Resultados"}),h&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Valida\xe7\xe3o da Planilha"}),(0,t.jsxs)("div",{className:"p-4 rounded-lg ".concat(h.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("span",{className:"text-2xl mr-2 ".concat(h.success?"text-green-600":"text-red-600"),children:h.success?"✅":"❌"}),(0,t.jsx)("span",{className:"font-medium ".concat(h.success?"text-green-800":"text-red-800"),children:h.success?"Valida\xe7\xe3o bem-sucedida":"Erros encontrados na valida\xe7\xe3o"})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,t.jsx)("strong",{children:"T\xedtulo:"})," ",h.spreadsheet_title||"N/A"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,t.jsx)("strong",{children:"Abas encontradas:"})," ",h.sheets_found.length]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:[(0,t.jsx)("strong",{children:"Abas suportadas:"})," ",h.data_structure.supported_sheets]}),h.validation_errors&&h.validation_errors.length>0&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-red-800 mb-1",children:"Erros encontrados:"}),(0,t.jsx)("ul",{className:"text-sm text-red-700 space-y-1",children:h.validation_errors.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})]})]})]}),p&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Resultado da Importa\xe7\xe3o"}),(0,t.jsxs)("div",{className:"p-4 rounded-lg ".concat(p.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)("span",{className:"text-2xl mr-2 ".concat(p.success?"text-green-600":"text-red-600"),children:p.success?"✅":"❌"}),(0,t.jsx)("span",{className:"font-medium ".concat(p.success?"text-green-800":"text-red-800"),children:p.message})]}),p.data_imported&&Object.keys(p.data_imported).length>0&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-800 mb-1",children:"Dados importados:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:Object.entries(p.data_imported).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-600",children:[s,":"]}),(0,t.jsx)("span",{className:"font-medium text-green-600",children:a})]},s)})})]}),p.errors&&p.errors.length>0&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-red-800 mb-1",children:"Erros:"}),(0,t.jsx)("ul",{className:"text-sm text-red-700 space-y-1",children:p.errors.map((e,s)=>(0,t.jsxs)("li",{children:["• ",e]},s))})]})]})]})]})]})}),f&&h&&(0,t.jsx)(o.Z,{isOpen:f,onClose:()=>b(!1),title:"Detalhes da Valida\xe7\xe3o",size:"xl",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Informa\xe7\xf5es Gerais"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"T\xedtulo:"}),(0,t.jsx)("span",{className:"font-medium",children:h.spreadsheet_title||"N/A"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Total de abas:"}),(0,t.jsx)("span",{className:"font-medium",children:h.sheets_found.length})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Abas suportadas:"}),(0,t.jsx)("span",{className:"font-medium text-green-600",children:h.data_structure.supported_sheets})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Status"}),(0,t.jsx)("div",{className:"p-3 rounded-lg ".concat(h.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-xl mr-2 ".concat(h.success?"text-green-600":"text-red-600"),children:h.success?"✅":"❌"}),(0,t.jsx)("span",{className:"font-medium ".concat(h.success?"text-green-800":"text-red-800"),children:h.success?"Pronto para importa\xe7\xe3o":"Requer aten\xe7\xe3o"})]})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"An\xe1lise das Abas"}),(0,t.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:h.data_structure.sheets_analysis.map((e,s)=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat("unknown"===e.type?"bg-gray-100 text-gray-600":"bg-blue-100 text-blue-800"),children:e.type})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,t.jsxs)("div",{children:["Linhas: ",e.rows," | Colunas: ",e.columns]}),e.headers.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"Cabe\xe7alhos:"})," ",e.headers.slice(0,5).join(", "),e.headers.length>5&&"..."]})]})]},s))})]})]})})]})}}},function(e){e.O(0,[607,899,785,774,888,179],function(){return e(e.s=32)}),_N_E=e.O()}]);